!function(){"use strict";class t{constructor(t,e){this.index=t,this.name=e.name,this.value=e.value,this.group=e.group||""}}class e{constructor(t){this.name=t,this.color="#0040ff",this.items=[]}get size(){return this.items.length}addItem(e){if(!(e instanceof t))throw Error("The item must be a instance of ItemElement");this.items.push(e)}}class i{constructor(t,e,i){this.ct=t.ct,this.doc=t.doc,this.cv=t.cv,this.options=e,this.data=i||[],this.groups=new Map,this.minv=Number.MAX_VALUE,this.maxv=Number.MIN_VALUE,this.maxt=0,this.maxn="",this.maxg="",this.xclass=[],this.calculateAll()}clear(){this.data=[],this.groups=new Map,this.minv=Number.MAX_VALUE,this.maxv=Number.MIN_VALUE,this.maxt=0,this.maxn="",this.maxg="",this.xclass=[]}calculateAll(){for(let t=0;t<this.data.length;t++)this.addItem(this.data[t])}calculateOne(t){this.minv>t.value&&(this.minv=t.value),this.maxv<t.value&&(this.maxv=t.value),this.maxn.length<t.name.length&&(this.maxn=t.name),this.maxg.length<t.group.length&&(this.maxg=t.group),this.maxt=Math.min(Tsart.Util.getMaxAxisValue(this.maxv),this.options.axis.y.maxValue),this.xclass.indexOf(t.name)<0&&this.xclass.push(t.name)}getGroup(t){let i=null;return void 0===t&&(t=""),this.groups.has(t)?i=this.groups.get(t):(i=new e(t),this.groups.set(t,i)),i}addItem(e){let i=this.getGroup(e.group);0==i.size&&(i.color=e.color);let o=new t(i.size,e);i.addItem(o),this.calculateOne(o)}update(){this.updateHeader(),this.updateLeft(),this.updateRight(),this.updateFooter(),this.updateClient()}updateHeader(){const t=this.options,e=this.cv.getContext("2d"),i=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),o=Tsart.Util.toPixel("50%",this.cv.width),l=Tsart.Util.toPixel("50%",i);e.clearRect(0,0,this.cv.width,i),t.title.content&&(e.fillStyle=t.title.fontColor,e.font=t.title.font,e.textAlign="center",e.textBaseline="middle",e.fillText(t.title.content,o,l))}updateLeft(){const t=this.options,e=this.cv.getContext("2d"),i=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),o=Tsart.Util.toPixel(t.regions.left.w,this.cv.width),l=this.cv.height-i-Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);e.clearRect(0,i,o,l),t.category.visible&&"left"===t.category.position&&this.updateCategory(e,Tsart.Util.toDim(0,i,o,l),t,this.groups)}updateRight(){const t=this.options,e=this.cv.getContext("2d"),i=Tsart.Util.toPixel(t.regions.right.w,this.cv.width),o=this.cv.width-i,l=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),s=this.cv.height-l-Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);e.clearRect(o,l,i,s),t.category.visible&&"right"===t.category.position&&this.updateCategory(e,Tsart.Util.toDim(o,l,i,s),t,this.groups)}updateCategory(t,e,i,o){let l=Math.min(e.h/o.size,20),s=parseInt(e.h/2-o.size*l/2,10);t.font=i.category.font,t.textAlign="start",t.textBaseline="middle";let a=0;for(let[n,r]of o)t.fillStyle=r.color,t.fillRect(e.x+10,e.y+s+l*a,20,.8*l),t.fillStyle=i.category.fontColor,t.fillText(n,e.x+34,e.y+s+l*a+.4*l),a++}updateFooter(){const t=this.options,e=this.cv.getContext("2d"),i=Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);e.clearRect(0,this.cv.height-i,this.cv.width,i)}updateClient(){const t=this.options,e=this.cv.getContext("2d"),i=Tsart.Util.toPixel(t.regions.left.w,this.cv.width),o=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),l=this.cv.width-i-Tsart.Util.toPixel(t.regions.right.w,this.cv.width),s=this.cv.height-o-Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);e.clearRect(i,o,l,s);const a=Tsart.Util.toDim(i+t.axis.x.marginLeft,o+t.axis.y.marginTop,l-t.axis.x.marginLeft-t.axis.x.marginRight,s-t.axis.y.marginTop-t.axis.y.marginBottom);this.updateGrid(e,a,t);for(let i of this.groups.values())this.updateArea(e,a,i,t)}updateGrid(t,e,i){const o={x:0,y:0},l=Tsart.Util.toSegment(e.l,e.b,e.r,e.b),s=Tsart.Util.toSegment("left"===i.axis.y.position?e.l:e.r,e.t,"left"===i.axis.y.position?e.l:e.r,e.b);t.lineWidth=1,t.strokeStyle=i.axis.x.lineColor,t.beginPath(),t.moveTo(l.x1,l.y1),t.lineTo(l.x2,l.y2),t.stroke(),i.axis.x.name&&(o.x="left"===i.axis.y.position?l.x2+10:l.x1-10,o.y=l.y2,t.font=i.axis.x.font,t.fillStyle=i.axis.x.fontColor,t.textAlign="left"===i.axis.y.position?"left":"right",t.textBaseline="top",t.fillText(i.axis.x.name,o.x,o.y));const a=e.w/this.xclass.length;t.font=i.axis.x.font,t.fillStyle=i.axis.x.fontColor,t.textAlign="center",t.textBaseline="top";for(let l=0;l<this.xclass.length;l++)o.x=e.x+l*a+a/2,o.y=e.b+10,t.fillText(this.xclass[l],o.x,o.y),i.axis.grid.xVisible&&(t.strokeStyle=i.axis.grid.xLineColor,t.beginPath(),t.moveTo(o.x+.5,e.t+.5),t.lineTo(o.x+.5,e.b+.5),t.stroke());t.strokeStyle=i.axis.y.lineColor,t.beginPath(),t.moveTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.stroke(),i.axis.y.name&&(o.x=s.x1,o.y=s.y1-10,t.font=i.axis.y.font,t.fillStyle=i.axis.y.fontColor,t.textAlign="center",t.textBaseline="bottom",t.fillText(i.axis.y.name,o.x,o.y));let n=i.axis.y.step,r="";for(let l=0;l<n;l++)o.x=s.x1,o.y=s.y2-s.h/n*(l+1),t.strokeStyle=i.axis.color,t.beginPath(),t.moveTo(o.x+.5,o.y+.5),t.lineTo(s.x1+("left"===i.axis.y.position?-5:5)+.5,o.y+.5),t.stroke(),r=""+this.maxt/n*(l+1),o.x="left"===i.axis.y.position?o.x-10:o.x+10,t.font=i.axis.y.font,t.fillStyle=i.axis.y.fontColor,t.textAlign="left"===i.axis.y.position?"right":"left",t.textBaseline="middle",t.fillText(r,o.x,o.y),i.axis.grid.yVisible&&(t.strokeStyle=i.axis.grid.yLineColor,t.beginPath(),t.moveTo(e.l+.5,o.y+.5),t.lineTo(e.r+.5,o.y+.5),t.stroke())}updateArea(t,e,i,o){const l={x:0,y:0};let s,a=0,n=0;const r=e.w/i.items.length,h=[];for(let l=0,x=null;l<i.items.length;l++)x=i.items[l],a=e.x+l*r+r/2,n=parseInt(e.b-x.value*e.h/this.maxt,10),h.push({x:a,y:n}),0===l?(s=1===o.item.areaAlpha?i.color:Tsart.Color.parseColor(i.color).setAlpha(.5).toRgbaString(),t.fillStyle=s,t.beginPath(),t.moveTo(a,e.b),t.lineTo(a,n)):l<i.items.length&&t.lineTo(a,n),l+1===i.items.length&&(t.lineTo(a,e.b),t.fill());for(let e=0;e<h.length;e++)0===e?(t.strokeStyle=i.color,t.lineWidth=1.5,t.beginPath(),t.moveTo(h[e].x+.5,h[e].y+.5)):e+1<h.length?t.lineTo(h[e].x+.5,h[e].y+.5):(t.lineTo(h[e].x+.5,h[e].y+.5),t.stroke());for(let e=0,s=null;e<h.length;e++)s=i.items[e],o.item.spotVisible&&(t.fillStyle="#fff",t.beginPath(),t.arc(h[e].x,h[e].y,3,0,2*Math.PI,!1),t.fill(),t.strokeStyle=i.color,t.strokeWidth=3,t.beginPath(),t.arc(h[e].x,h[e].y,3,0,2*Math.PI,!1),t.stroke()),e+1===h.length&&o.item.labelVisible&&(l.x=h[e].x+10,l.y=h[e].y,t.textAlign="start",t.textBaseline="middle",t.fillStyle=i.color,t.fillText(i.name,l.x,l.y)),o.item.valueVisible&&(l.x=h[e].x,l.y=h[e].y-10,t.textAlign="center",t.textBaseline="bottom",t.fillStyle=i.color,t.fillText(s.value,l.x,l.y))}}Tsart.charts.set("line-area",function(t,e,o){e=Tsart.Util.extend({title:{content:"",font:"bold 32px 'Arial'",fontColor:"#999999"},regions:{header:{h:"0",bkcolor:"#fff"},left:{w:"0",bkcolor:"#fff"},right:{w:"0",bkcolor:"#fff"},footer:{h:"0",bkcolor:"#fff"},client:{bkcolor:"#fff"}},category:{visible:!1,position:"left",font:"normal 11px 'Arial'",fontColor:"#000"},axis:{x:{name:"",font:"normal 11px 'Arial'",fontColor:"#000",marginLeft:50,marginRight:50,lineColor:"#aaa"},y:{name:"",font:"normal 11px 'Arial'",fontColor:"#000",marginTop:50,marginBottom:50,lineColor:"#aaa",step:10,maxValue:Number.MAX_VALUE,position:"left"},grid:{xLineColor:"#ddd",xVisible:!0,yLineColor:"#ddd",yVisible:!0}},item:{areaAlpha:1,spotVisible:!0,labelVisible:!0,valueVisible:!0}},e);const l=new i(t,e,o);return l.update(),l})}();