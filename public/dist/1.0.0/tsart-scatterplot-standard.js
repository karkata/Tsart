!function(){class t{constructor(t,i){this.name=t,this.color=i||"#0080FF",this.items=[]}get size(){return this.items.length}addItem(t){if(!(t instanceof i))throw Error("The item must be a instance of ItemElement");this.items.push(t)}}class i{constructor(t,i){this.index=t,this.x=i.x,this.y=i.y,this.w=i.w,this.group=i.group||""}}class e{constructor(t,i,e){this.ct=t.ct,this.doc=t.doc,this.cv=t.cv,this.options=i,this.data=e||[],this.groups=new Map,this.minxv=Number.MAX_VALUE,this.maxxv=Number.MIN_VALUE,this.minyv=Number.MAX_VALUE,this.maxyv=Number.MIN_VALUE,this.minwv=Number.MAX_VALUE,this.maxwv=Number.MIN_VALUE,this.minxt=0,this.minyt=0,this.maxxt=0,this.maxyt=0,this.maxg="",this.calculateAll()}calculateAll(){for(let t=0;t<this.data.length;t++)this.addItem(this.data[t])}calculateOne(t){this.minxv>t.x&&(this.minxv=t.x),this.maxxv<t.x&&(this.maxxv=t.x),this.minyv>t.y&&(this.minyv=t.y),this.maxyv<t.y&&(this.maxyv=t.y),this.minwv>t.w&&(this.minwv=t.w),this.maxwv<t.w&&(this.maxwv=t.w),this.maxg.length<t.group.length&&(this.maxg=t.group),this.minxt=this.options.axis.x.minValue,this.minyt=this.options.axis.y.minValue,this.maxxt=Math.min(Tsart.Util.getMaxAxisValue(this.maxxv),this.options.axis.x.maxValue),this.maxyt=Math.min(Tsart.Util.getMaxAxisValue(this.maxyv),this.options.axis.y.maxValue)}clearItems(){this.data=[],this.groups=new Map,this.minxv=Number.MAX_VALUE,this.maxxv=Number.MIN_VALUE,this.minyv=Number.MAX_VALUE,this.maxyv=Number.MIN_VALUE,this.minwv=Number.MAX_VALUE,this.maxwv=Number.MIN_VALUE,this.minxt=0,this.minyt=0,this.maxxt=0,this.maxyt=0,this.maxg=""}addItem(e){let s=null;void 0===e.group&&(e.group=""),this.groups.has(e.group)?s=this.groups.get(e.group):(s=new t(e.group,e.color),this.groups.set(e.group,s));let o=new i(s.size,e);s.addItem(o),this.calculateOne(o)}update(){this.updateHeader(),this.updateLeft(),this.updateRight(),this.updateFooter(),this.updateClient()}updateHeader(){const t=this.options,i=this.cv.getContext("2d"),e=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),s=Tsart.Util.toPixel("50%",this.cv.width),o=Tsart.Util.toPixel("50%",e);i.clearRect(0,0,this.cv.width,e),t.title.content&&(i.fillStyle=t.title.fontColor,i.font=t.title.font,i.textAlign="center",i.textBaseline="middle",i.fillText(t.title.content,s,o))}updateLeft(){const t=this.options,i=this.cv.getContext("2d"),e=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),s=Tsart.Util.toPixel(t.regions.left.w,this.cv.width),o=this.cv.height-e-Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);i.clearRect(0,e,s,o),t.category.visible&&"left"===t.category.position&&this.updateCategory(i,Tsart.Util.toDim(0,e,s,o),t,this.groups)}updateRight(){const t=this.options,i=this.cv.getContext("2d"),e=Tsart.Util.toPixel(t.regions.right.w,this.cv.width),s=this.cv.width-e,o=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),a=this.cv.height-o-Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);i.clearRect(s,o,e,a),t.category.visible&&"right"===t.category.position&&this.updateCategory(i,Tsart.Util.toDim(s,o,e,a),t,this.groups)}updateCategory(t,i,e,s){let o=Math.min(i.h/s.size,20),a=parseInt(i.h/2-s.size*o/2,10);t.font=e.category.font,t.textAlign="start",t.textBaseline="middle";let l=-1,h={x:0,y:0};for(let[n,r]of s)l++,h.x=i.x+15,h.y=i.y+a+o*l+o/2,t.fillStyle=r.color,t.beginPath(),t.moveTo(h.x,h.y),t.arc(h.x,h.y,3,0,2*Math.PI),t.fill(),t.fillStyle=e.category.fontColor,t.fillText(n,i.x+30,h.y)}updateFooter(){const t=this.options,i=this.cv.getContext("2d"),e=Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);i.clearRect(0,this.cv.height-e,this.cv.width,e)}updateClient(){const t=this.options,i=this.cv.getContext("2d"),e=Tsart.Util.toPixel(t.regions.left.w,this.cv.width),s=Tsart.Util.toPixel(t.regions.header.h,this.cv.height),o=this.cv.width-e-Tsart.Util.toPixel(t.regions.right.w,this.cv.width),a=this.cv.height-s-Tsart.Util.toPixel(t.regions.footer.h,this.cv.height);i.clearRect(e,s,o,a);const l=Tsart.Util.toDim(e+t.axis.x.marginLeft,s+t.axis.y.marginTop,o-t.axis.x.marginLeft-t.axis.x.marginRight,a-t.axis.y.marginTop-t.axis.y.marginBottom);this.updateGrid(i,l,t),this.updateScatterplot(i,l,t)}updateGrid(t,i,e){const s={x:0,y:0},o=Tsart.Util.toSegment(i.l,i.b,i.r,i.b),a=Tsart.Util.toSegment(i.l,i.t,i.l,i.b);t.lineWidth=1,t.strokeStyle=e.axis.x.lineColor,t.beginPath(),t.moveTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.stroke(),e.axis.x.name&&(s.x=o.x2+10,s.y=o.y2,t.font=e.axis.x.font,t.fillStyle=e.axis.x.fontColor,t.textAlign="left",t.textBaseline="top",t.fillText(e.axis.x.name,s.x,s.y));let l=e.axis.x.step,h="";for(let a=0;a<l;a++)s.x=o.x1+o.w/l*(a+1),s.y=o.y1,t.strokeStyle=e.axis.color,t.beginPath(),t.moveTo(s.x+.5,s.y+.5),t.lineTo(s.x+.5,s.y+5+.5),t.stroke(),h=""+(this.minxt+(this.maxxt-this.minxt)/l*(a+1)),t.font=e.axis.x.font,t.fillStyle=e.axis.x.fontColor,t.textAlign="center",t.textBaseline="top",t.fillText(h,s.x,s.y+10),e.axis.grid.visible&&(t.strokeStyle=e.axis.grid.lineColor,t.lineWidth=.5,t.beginPath(),t.moveTo(s.x+.5,i.t+.5),t.lineTo(s.x+.5,i.b+.5),t.stroke());t.strokeStyle=e.axis.y.lineColor,t.beginPath(),t.moveTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.stroke(),e.axis.y.name&&(s.x=a.x1,s.y=a.y1-10,t.font=e.axis.y.font,t.fillStyle=e.axis.y.fontColor,t.textAlign="center",t.textBaseline="bottom",t.fillText(e.axis.y.name,s.x,s.y)),l=e.axis.y.step;for(let o=0;o<l;o++)s.x=a.x1,s.y=a.y2-a.h/l*(o+1),t.strokeStyle=e.axis.color,t.lineWidth=.5,t.beginPath(),t.moveTo(s.x+.5,s.y+.5),t.lineTo(a.x1-5+.5,s.y+.5),t.stroke(),h=""+(this.minyt+(this.maxyt-this.minyt)/l*(o+1)),s.x=s.x-10,t.font=e.axis.y.font,t.fillStyle=e.axis.y.fontColor,t.textAlign="right",t.textBaseline="middle",t.fillText(h,s.x,s.y),e.axis.grid.visible&&(t.strokeStyle=e.axis.grid.lineColor,t.beginPath(),t.moveTo(i.l+.5,s.y+.5),t.lineTo(i.r+.5,s.y+.5),t.stroke())}updateScatterplot(t,i,e){const s={x:0,y:0},o=this.maxxt-this.minxt,a=this.maxyt-this.minyt;let l=0,h=0,n=0;e.item.useWeight&&(l=this.maxwv-this.minwv,n=e.item.bubbleMaxRadius-e.item.bubbleMinRadius);for(let r of this.groups.values()){t.fillStyle=r.color;for(let x=0,m=null;x<r.items.length;x++)m=r.items[x],s.x=i.l+parseInt(i.w*(m.x-this.minxt)/o,10),s.y=i.b-parseInt(i.h*(m.y-this.minyt)/a,10),t.beginPath(),t.moveTo(s.x,s.y),e.item.useWeight&&l>0?(h=m.w-this.minwv,t.arc(s.x,s.y,n*h/l,0,2*Math.PI)):t.arc(s.x,s.y,e.item.size,0,2*Math.PI),t.fill()}}}Tsart.charts.set("scatterplot-standard",function(t,i,s){i=Tsart.Util.extend({title:{content:"",font:"bold 32px 'Arial'",fontColor:"#999999"},regions:{header:{h:"0",bkcolor:"#fff"},left:{w:"0",bkcolor:"#fff"},right:{w:"0",bkcolor:"#fff"},footer:{h:"0",bkcolor:"#fff"},client:{bkcolor:"#fff"}},category:{visible:!1,position:"left",font:"normal 11px 'Arial'",fontColor:"#000"},axis:{x:{name:"",font:"normal 11px 'Arial'",fontColor:"#000",marginLeft:50,marginRight:50,lineColor:"#aaa",step:10,minValue:0,maxValue:Number.MAX_VALUE},y:{name:"",font:"normal 11px 'Arial'",fontColor:"#000",marginTop:50,marginBottom:50,lineColor:"#aaa",step:10,minValue:0,maxValue:Number.MAX_VALUE},grid:{lineColor:"#ddd",visible:!0}},item:{size:3,useWeight:!1,bubbleMinRadius:0,bubbleMaxRadius:10}},i);const o=new e(t,i,s);return o.update(),o})}();